use std::error::Error;

use api::Configuration;
use api::database::Manager;
use api::database::models::Customers;
use tokio::sync::mpsc::channel;

#[tokio::main]
async fn main() -> Result<(), Box<dyn Error>> {
    let conf = Configuration::new("./configs/api.yml").await?;
    let (s, r) = channel::<Customers>(10000);
    let mut manager = Manager::new(r, 50, conf.0[0]["db"]["url"].as_str().unwrap()).await;
    let r = manager.start()?;
    Ok(())
}
